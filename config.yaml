# Nurdle Detection Pipeline - Two-Stage Detection Configuration
# ==============================================================
# SVM Classifier → SVR Regressor → Optional Stacking
# Optimized for simplicity and correctness

# Project Information
project:
  name: "Nurdle Detection Pipeline"
  version: "2.0.0"
  description: "Two-stage nurdle detection with SVM classifier and SVR coordinate regression"

# Data Processing Configuration
data:
  train_test_ratio: 0.8           # Fraction for training (0.8 = 80% train, 20% test)
  target_resolution: 1080         # Target image resolution for normalization
  batch_size: 30                  # Images per RAM batch (memory management)
  input_dir: "input"              # Input directory with images and JSON files
  output_dir: "output"            # Output directory for results
  save_dir: "saved_outputs"       # Directory to save zipped output folders (set to null to disable)
  count_bins: [0, 20, 40, 60, 80, 110, 150, 220, 1000000000]  # Stratify high-count tail separately
  cv_folds: 5                    # Folds for stratified CV (reduce if data is very small)

# Feature Extraction Configuration  
features:
  hog_cell_size: [8, 8]           # HOG cell size (image size derived from data.target_resolution)
  use_hog: false                 # Disable HOG (LBP-only per ablation)
  use_lbp: true                   # Toggle LBP features (set false for ablation)
  segmentation:
    min_dist: 8                   # Minimum distance between nurdle centers (watershed parameter)
    min_area: 50                  # Minimum nurdle area in pixels
    max_area: 2000                # Maximum nurdle area in pixels

# Evaluation Configuration  
evaluation:
  per_model: true  # Enable separate evaluation for each model type
  
# Hyperparameter Optimization Configuration
optimization:
  svr:
    n_trials: 10
    c_min: 0.1
    c_max: 3.0                    # Shrink C range to reduce capacity
    eps_min: 0.05
    eps_max: 0.5
    kernel: rbf              # Simpler kernel to discourage overfitting
    gamma: scale                  # Ignored for linear kernel; kept for compatibility
    
# Pipeline Control
pipeline:
  # Default steps to run (can be overridden via --steps argument)
  steps:
    - normalization
    - features
    - training
    - evaluation
  
  # Checkpoints configuration
  checkpoints:
    enabled: true  # Enable checkpoint save/load
    
  # Error handling
  error_handling:
    continue_on_error: false  # Whether to continue pipeline if a step fails
    save_error_logs: true  # Save detailed error information
    
  # Cleanup
  cleanup:
    remove_temp_files: false  # Clean up temporary files after completion (set to false to keep checkpoints)
    keep_intermediate_results: true  # Keep intermediate results for inspection
